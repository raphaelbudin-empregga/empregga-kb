version: '3.8'

services:
  orion-portal:
    image: ghcr.io/${GHCR_IMAGE_NAMESPACE}/${PORTAL_IMAGE_NAME}:${PORTAL_IMAGE_TAG}
    # As variáveis de ambiente devem ser definidas direto na UI do Portainer
    # (aba de Environment da stack) ou, em ambiente local, via `docker compose --env-file .env up`.
    # Se quiser definir variáveis estáticas baseadas no Traefik (substitua a URL pela real),
    # use o bloco abaixo como exemplo:
    # environment:
    #   NODE_ENV: production
    labels:
      - "traefik.enable=true"
      # URL externa para agentes acessarem o bot: intel.empregga.com.br
      - "traefik.http.routers.orion.rule=Host(`intel.empregga.com.br`)"
      - "traefik.http.routers.orion.entrypoints=websecure"
      - "traefik.http.routers.orion.tls=true"
      - "traefik.http.routers.orion.tls.certresolver=letsencrypt" # Nome do resolver no seu Traefik VPS
      - "traefik.http.services.orion.loadbalancer.server.port=3000"
    networks:
      - network_public # NOME da rede do traefik já existente no seu Portainer

# Declarando a conexão com a rede externa que o Traefik usa
networks:
  network_public:
    external: true
